# TreasureHunt

Minecraft内で宝探しゲームをするためのプラグインです。

Javaの学習用に初学者が作成しています。

> [!WARNING]
> 一般配布は想定しておらず、スコア情報を保存するためのデータベースは、ローカル環境のMySQLを使用しています。  
 ご利用いただく際は**ご自身のデータベースが必要となります**ので、ご注意ください。
> 
> また、本プラグインをご利用いただくことで起こり得るトラブル等については、***一切の責任を負いかねます***ので、ご利用はご自身の判断でお願いいたします。

# 概要

* 「/treasurehunt easy」のように、ゲーム名＋難易度をコマンド入力すると、宝探しゲームを開始します。

* ゲーム開始前のカウントダウン終了後、難易度に応じたブロックが指定され、そのブロックを入手するまでにかかった時間でスコアを競います。

* ブロックの種類によってボーナススコアも設定されており、ゲーム終了時のスコアに加算されます。（作成者がMinecraft初心者のため、ボーナススコアのバランスがおかしい可能性があります。予めご了承ください。）


# デモ動画

**※画面酔いにご注意ください。**

https://github.com/EMstwk/TreasureHunt/assets/134411910/7636895e-cacf-4881-9d4a-0f84cd83b672


# 対応バージョン

* Java版 Minecraft 1.20.1
* Spigot 1.20.1
* Java SE 17.0.7

　※Macでのみ動作確認済みです。


# ご利用方法

1. プラグインの導入をする前に、**データベースの情報を変更**してください。
    - 本プラグインのコードをダウンロードまたはコピーし、[TreasureHunt/src/main/resources/mybatis-config.xml](src/main/resources/mybatis-config.xml)内の13〜16行目他必要な箇所を、
ご自身のデータベースの情報で上書きしてください。
    - MySQLのデータベース作成サンプル
      ```
      CREATE DATABASE TREASUREHUNT_RESULTS;
      USE TREASUREHUNT_RESULTS;
      CREATE TABLE player_score(id int auto_increment, player_name varchar(50), score int, difficulty varchar(30), jpTreasureName varchar(30), registered_at datetime, primary key(id));
      ```
    - gradle shadowJar等で、変更後の内容を反映したfat Jarを作成してください。

2. 先ほど作成したfat Jarファイル（[TreasureHunt/build/libs/TreasureHunt-1.0-SNAPSHOT-all.jar](build/libs/TreasureHunt-1.0-SNAPSHOT-all.jar)のファイル）を、
ご自身のMinecraftサーバーの「**plugins**」フォルダの中に追加してください。

3. サーバーを起動し、「/treasurehunt easy」等のコマンドが実行できるかご確認ください。


# コマンド

　**/treasurehunt easy** -> イージーモードで宝探しゲームを実行  
　**/treasurehunt normal** -> ノーマルモードで宝探しゲームを実行  
　**/treasurehunt hard** -> ハードモードで宝探しゲームを実行
 
　**/treasurehunt list** -> 過去の結果を、スコアの高い順かつ新しい順に上位5件のみ表示

　**/huntstatus** -> コマンド入力時点での取得可能スコアを、ボーナススコアも含めて表示  
　**/huntend** -> 実行中の宝探しゲームを強制終了


# 機能まとめ

※コード内のJavadocでは、使用するコードから宝探しの対象を「マテリアル」と記載していますが、ここではそのもの自体をわかりやすくするため「ブロック」という表現を用いています。

* ゲーム開始のコマンド（treasurehunt + 難易度）を実行すると、難易度ごとに設定されたブロックのリストから、ランダムで宝探しの対象ブロックが指定されます。
  - 指定されたブロックは、タイトル表示とメッセージ欄でプレイヤーに表示されます。
  - 対象ブロック、ボーナススコアの情報は、[TreasureHunt/src/main/resources/config.yml](src/main/resources/config.yml)から変更可能です。変更の際は日本語名も手動で追加をお願いします。
* ゲームを開始時にスケジューラが実行され、対象ブロックを入手するまでにかかった時間により、ゲームスコアが変動します。
* 対象ブロックの種類により、ゲームスコアにボーナススコアが加算されます。
* 対象ブロックを入手すると、合計スコアをタイトル表示とメッセージ欄で表示します。
* ゲームの結果（プレイヤー名、合計スコア、難易度、対象ブロック、プレイ日時）は、データベースに保存されます。
* 保存されたゲームの結果は、リストとして上位5件まで表示できます。  
  - 難易度ごとの表示や新着順のリスト等は、引数・メソッドの追加で可能になりますが、現時点では入れていません。  
　
* ゲーム開始のコマンド実行後、5秒間のカウントダウンが表示されます。カウントダウンの終了と同時に対象ブロックが表示され、ゲーム開始となります。
* ゲームの途中でも、huntstatusコマンドで入力時点での取得可能スコアを確認できます。  
　
* ゲームの途中でも、huntendコマンドで実行中のゲームを強制終了させることができます。
* 制限時間は5分間で、画面上部のボスバーで常に残り時間を確認できます。
* 残り時間は、1分単位と、残り10秒になった際に、タイトル表示します。
* ゲーム開始時にプレイヤーの体力と満腹度を最大にし、特殊効果は削除します。  
  - 開始直後に元のステータスが原因でリスポーンするなどのタイムロスを減らすための措置です。
  - 武器、道具に関しては、プレイヤー自身の所持品からも難易度の選択や高得点を狙うなどしてもらえるように、あえて統一はしていません。


# 最後に

最初に記載した通り、あくまでもJava初学者の練習用ということをご理解いただけると幸いです。  
READMEも現状探り探りで作成しているので、今後さらにブラッシュアップしていきたいところです。
